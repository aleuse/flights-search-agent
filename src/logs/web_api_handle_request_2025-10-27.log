2025-10-27 19:54:31,184 - web_api_handle_request - INFO - execute:12 - Received request to generate response for query: hola...
2025-10-27 19:54:31,185 - web_api_handle_request - INFO - log_function_call:39 - Calling execute with params: {
  "user_query_length": 4,
  "user_query_preview": "hola"
}
2025-10-27 19:54:31,191 - web_api_handle_request - ERROR - log_function_error:51 - execute failed with error: cannot import name 'TravelPrompts' from 'travel_agent.domain.prompts' (D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\travel_agent\domain\prompts.py) | Params: {"user_query_length": 4, "user_query_preview": "hola"}
Traceback (most recent call last):
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\web_api\application\handle_request.py", line 35, in execute
    output  = await self.graph.ainvoke(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\main.py", line 3182, in ainvoke
    async for chunk in self.astream(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\main.py", line 3000, in astream
    async for _ in runner.atick(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\_runner.py", line 304, in atick
    await arun_with_retry(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 705, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 473, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\travel_agent\application\nodes.py", line 26, in check_user_query
    from travel_agent.domain.prompts import TravelPrompts
ImportError: cannot import name 'TravelPrompts' from 'travel_agent.domain.prompts' (D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\travel_agent\domain\prompts.py)
During task with name 'check_user_query' and id '4ddd7e41-cb23-ac12-3826-ff15f65cb1be'
2025-10-27 19:54:31,209 - web_api_handle_request - ERROR - execute:55 - Failed to handle request for query: hola...
2025-10-27 19:55:24,480 - web_api_handle_request - INFO - execute:12 - Received request to generate response for query: hola...
2025-10-27 19:55:24,480 - web_api_handle_request - INFO - log_function_call:39 - Calling execute with params: {
  "user_query_length": 4,
  "user_query_preview": "hola"
}
2025-10-27 19:55:24,488 - web_api_handle_request - ERROR - log_function_error:51 - execute failed with error: 'LLMChainRequest' object has no attribute 'model' | Params: {"user_query_length": 4, "user_query_preview": "hola"}
Traceback (most recent call last):
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\web_api\application\handle_request.py", line 35, in execute
    output  = await self.graph.ainvoke(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\main.py", line 3182, in ainvoke
    async for chunk in self.astream(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\main.py", line 3000, in astream
    async for _ in runner.atick(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\_runner.py", line 304, in atick
    await arun_with_retry(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 705, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 473, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\travel_agent\application\nodes.py", line 39, in check_user_query
    response_chain = await self.llm_service.get_chain(chain_request)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\llms\infrastructure\google_service.py", line 21, in get_chain
    llm = self.client.get_llm(temperature=request.temperature, model=request.model)
                                                                     ^^^^^^^^^^^^^
AttributeError: 'LLMChainRequest' object has no attribute 'model'
During task with name 'check_user_query' and id '46256839-2718-5c34-9e18-dff21ee8bdd9'
2025-10-27 19:55:24,492 - web_api_handle_request - ERROR - execute:55 - Failed to handle request for query: hola...
2025-10-27 19:57:07,682 - web_api_handle_request - INFO - execute:12 - Received request to generate response for query: hola...
2025-10-27 19:57:07,682 - web_api_handle_request - INFO - log_function_call:39 - Calling execute with params: {
  "user_query_length": 4,
  "user_query_preview": "hola"
}
2025-10-27 19:57:08,093 - web_api_handle_request - ERROR - log_function_error:51 - execute failed with error: jinja2 not installed, which is needed to use the jinja2_formatter. Please install it with `pip install jinja2`. | Params: {"user_query_length": 4, "user_query_preview": "hola"}
Traceback (most recent call last):
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\web_api\application\handle_request.py", line 35, in execute
    output  = await self.graph.ainvoke(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\main.py", line 3182, in ainvoke
    async for chunk in self.astream(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\main.py", line 3000, in astream
    async for _ in runner.atick(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\_runner.py", line 304, in atick
    await arun_with_retry(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 705, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 473, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\travel_agent\application\nodes.py", line 39, in check_user_query
    response_chain = await self.llm_service.get_chain(chain_request)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\llms\infrastructure\google_service.py", line 30, in get_chain
    prompt = ChatPromptTemplate.from_messages([
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\prompts\chat.py", line 1136, in from_messages
    return cls(messages, template_format=template_format)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\prompts\chat.py", line 945, in __init__
    messages_ = [
                ^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\prompts\chat.py", line 946, in <listcomp>
    _convert_to_message_template(message, template_format)
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\prompts\chat.py", line 1418, in _convert_to_message_template
    message_ = _create_template_from_message_type(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\prompts\chat.py", line 1325, in _create_template_from_message_type
    message = SystemMessagePromptTemplate.from_template(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\prompts\chat.py", line 426, in from_template
    prompt: StringPromptTemplate | list = PromptTemplate.from_template(
                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\prompts\prompt.py", line 289, in from_template
    input_variables = get_template_variables(template, template_format)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\prompts\string.py", line 263, in get_template_variables
    input_variables = _get_jinja2_variables_from_template(template)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\prompts\string.py", line 103, in _get_jinja2_variables_from_template
    raise ImportError(msg)
ImportError: jinja2 not installed, which is needed to use the jinja2_formatter. Please install it with `pip install jinja2`.
During task with name 'check_user_query' and id 'f62326c9-50c4-2d43-32b8-9957b86a58a5'
2025-10-27 19:57:08,097 - web_api_handle_request - ERROR - execute:55 - Failed to handle request for query: hola...
2025-10-27 19:59:59,270 - web_api_handle_request - INFO - execute:12 - Received request to generate response for query: hola...
2025-10-27 19:59:59,270 - web_api_handle_request - INFO - log_function_call:39 - Calling execute with params: {
  "user_query_length": 4,
  "user_query_preview": "hola"
}
2025-10-27 19:59:59,296 - web_api_handle_request - ERROR - log_function_error:51 - execute failed with error: 'LLMChain' object has no attribute 'ainvoke' | Params: {"user_query_length": 4, "user_query_preview": "hola"}
Traceback (most recent call last):
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\web_api\application\handle_request.py", line 35, in execute
    output  = await self.graph.ainvoke(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\main.py", line 3182, in ainvoke
    async for chunk in self.astream(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\main.py", line 3000, in astream
    async for _ in runner.atick(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\_runner.py", line 304, in atick
    await arun_with_retry(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 705, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 473, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\travel_agent\application\nodes.py", line 43, in check_user_query
    response = await response_chain.ainvoke(
                     ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'LLMChain' object has no attribute 'ainvoke'
During task with name 'check_user_query' and id 'f7651525-d4e6-2fca-e416-9591567edca3'
2025-10-27 19:59:59,299 - web_api_handle_request - ERROR - execute:55 - Failed to handle request for query: hola...
2025-10-27 20:00:59,257 - web_api_handle_request - INFO - execute:12 - Received request to generate response for query: hola...
2025-10-27 20:00:59,257 - web_api_handle_request - INFO - log_function_call:39 - Calling execute with params: {
  "user_query_length": 4,
  "user_query_preview": "hola"
}
2025-10-27 20:00:59,285 - web_api_handle_request - ERROR - log_function_error:51 - execute failed with error: "Input to ChatPromptTemplate is missing variables {'agent_scratchpad'}.  Expected: ['agent_scratchpad', 'user_query'] Received: ['messages', 'user_query']\nNote: if you intended {agent_scratchpad} to be part of the string and not a variable, please escape it with double curly braces like: '{{agent_scratchpad}}'.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_PROMPT_INPUT " | Params: {"user_query_length": 4, "user_query_preview": "hola"}
Traceback (most recent call last):
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\web_api\application\handle_request.py", line 35, in execute
    output  = await self.graph.ainvoke(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\main.py", line 3182, in ainvoke
    async for chunk in self.astream(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\main.py", line 3000, in astream
    async for _ in runner.atick(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\_runner.py", line 304, in atick
    await arun_with_retry(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 705, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 473, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\travel_agent\application\nodes.py", line 43, in check_user_query
    response = await response_chain.chain.ainvoke(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3130, in ainvoke
    input_ = await coro_with_context(part(), context, create_task=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\prompts\base.py", line 235, in ainvoke
    return await self._acall_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 2072, in _acall_with_config
    output: Output = await coro_with_context(coro, context)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\prompts\base.py", line 188, in _aformat_prompt_with_error_handling
    inner_input_ = self._validate_input(inner_input)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\prompts\base.py", line 176, in _validate_input
    raise KeyError(
KeyError: "Input to ChatPromptTemplate is missing variables {'agent_scratchpad'}.  Expected: ['agent_scratchpad', 'user_query'] Received: ['messages', 'user_query']\nNote: if you intended {agent_scratchpad} to be part of the string and not a variable, please escape it with double curly braces like: '{{agent_scratchpad}}'.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_PROMPT_INPUT "
During task with name 'check_user_query' and id 'e012dc79-de6b-de47-ecfb-c454d764bacb'
2025-10-27 20:00:59,287 - web_api_handle_request - ERROR - execute:55 - Failed to handle request for query: hola...
2025-10-27 20:02:01,596 - web_api_handle_request - INFO - execute:12 - Received request to generate response for query: hola...
2025-10-27 20:02:01,596 - web_api_handle_request - INFO - log_function_call:39 - Calling execute with params: {
  "user_query_length": 4,
  "user_query_preview": "hola"
}
2025-10-27 20:02:03,322 - web_api_handle_request - ERROR - log_function_error:51 - execute failed with error: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=IsValid(is_valid=False, r...rt date, and end date.'), input_type=IsValid]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type | Params: {"user_query_length": 4, "user_query_preview": "hola"}
Traceback (most recent call last):
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\web_api\application\handle_request.py", line 35, in execute
    output  = await self.graph.ainvoke(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\main.py", line 3182, in ainvoke
    async for chunk in self.astream(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\main.py", line 3000, in astream
    async for _ in runner.atick(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\_runner.py", line 304, in atick
    await arun_with_retry(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 705, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 473, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\travel_agent\application\nodes.py", line 43, in check_user_query
    response = await response_chain.chain.ainvoke(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3130, in ainvoke
    input_ = await coro_with_context(part(), context, create_task=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 228, in ainvoke
    return await self._acall_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 2069, in _acall_with_config
    coro = acall_func_with_variable_args(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 462, in acall_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 229, in <lambda>
    lambda inner_input: self.aparse_result([Generation(text=inner_input)]),
                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\load\serializable.py", line 113, in __init__
    super().__init__(*args, **kwargs)
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\pydantic\main.py", line 250, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=IsValid(is_valid=False, r...rt date, and end date.'), input_type=IsValid]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
During task with name 'check_user_query' and id 'a6c96171-0fea-c466-11eb-695a94655fda'
2025-10-27 20:02:03,325 - web_api_handle_request - ERROR - execute:55 - Failed to handle request for query: hola...
2025-10-27 20:03:04,911 - web_api_handle_request - INFO - execute:12 - Received request to generate response for query: hola...
2025-10-27 20:03:04,911 - web_api_handle_request - INFO - log_function_call:39 - Calling execute with params: {
  "user_query_length": 4,
  "user_query_preview": "hola"
}
2025-10-27 20:03:07,218 - web_api_handle_request - ERROR - log_function_error:51 - execute failed with error: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=IsValid(is_valid='False',... End Date are missing.'), input_type=IsValid]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type | Params: {"user_query_length": 4, "user_query_preview": "hola"}
Traceback (most recent call last):
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\web_api\application\handle_request.py", line 35, in execute
    output  = await self.graph.ainvoke(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\main.py", line 3182, in ainvoke
    async for chunk in self.astream(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\main.py", line 3000, in astream
    async for _ in runner.atick(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\_runner.py", line 304, in atick
    await arun_with_retry(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 705, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 473, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\travel_agent\application\nodes.py", line 43, in check_user_query
    response = await response_chain.chain.ainvoke(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3130, in ainvoke
    input_ = await coro_with_context(part(), context, create_task=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 228, in ainvoke
    return await self._acall_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 2069, in _acall_with_config
    coro = acall_func_with_variable_args(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 462, in acall_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 229, in <lambda>
    lambda inner_input: self.aparse_result([Generation(text=inner_input)]),
                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\load\serializable.py", line 113, in __init__
    super().__init__(*args, **kwargs)
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\pydantic\main.py", line 250, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=IsValid(is_valid='False',... End Date are missing.'), input_type=IsValid]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
During task with name 'check_user_query' and id 'fa5c762e-7fe7-8787-0694-a3c35d167cff'
2025-10-27 20:03:07,222 - web_api_handle_request - ERROR - execute:55 - Failed to handle request for query: hola...
2025-10-27 20:06:16,980 - web_api_handle_request - INFO - execute:12 - Received request to generate response for query: hola...
2025-10-27 20:06:16,980 - web_api_handle_request - INFO - log_function_call:39 - Calling execute with params: {
  "user_query_length": 4,
  "user_query_preview": "hola"
}
2025-10-27 20:06:18,925 - web_api_handle_request - ERROR - log_function_error:51 - execute failed with error: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=IsValid(is_valid='False',..., Start Date, End Date'), input_type=IsValid]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type | Params: {"user_query_length": 4, "user_query_preview": "hola"}
Traceback (most recent call last):
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\web_api\application\handle_request.py", line 35, in execute
    output  = await self.graph.ainvoke(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\main.py", line 3182, in ainvoke
    async for chunk in self.astream(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\main.py", line 3000, in astream
    async for _ in runner.atick(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\_runner.py", line 304, in atick
    await arun_with_retry(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 705, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 473, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\travel_agent\application\nodes.py", line 43, in check_user_query
    response = await response_chain.chain.ainvoke(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 3130, in ainvoke
    input_ = await coro_with_context(part(), context, create_task=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 228, in ainvoke
    return await self._acall_with_config(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\runnables\base.py", line 2069, in _acall_with_config
    coro = acall_func_with_variable_args(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\runnables\config.py", line 462, in acall_func_with_variable_args
    return func(input, **kwargs)  # type: ignore[call-arg]
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\output_parsers\base.py", line 229, in <lambda>
    lambda inner_input: self.aparse_result([Generation(text=inner_input)]),
                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langchain_core\load\serializable.py", line 113, in __init__
    super().__init__(*args, **kwargs)
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\pydantic\main.py", line 250, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pydantic_core._pydantic_core.ValidationError: 1 validation error for Generation
text
  Input should be a valid string [type=string_type, input_value=IsValid(is_valid='False',..., Start Date, End Date'), input_type=IsValid]
    For further information visit https://errors.pydantic.dev/2.12/v/string_type
During task with name 'check_user_query' and id '43bc95bb-8958-64ef-f04d-4328f46205e8'
2025-10-27 20:06:18,928 - web_api_handle_request - ERROR - execute:55 - Failed to handle request for query: hola...
2025-10-27 20:09:38,459 - web_api_handle_request - INFO - execute:12 - Received request to generate response for query: hola...
2025-10-27 20:09:38,459 - web_api_handle_request - INFO - log_function_call:39 - Calling execute with params: {
  "user_query_length": 4,
  "user_query_preview": "hola"
}
2025-10-27 20:09:39,969 - web_api_handle_request - INFO - log_function_result:44 - execute completed successfully. Result: {
  "response_length": 49,
  "response_preview": "Missing Origin, Destination, Start Date, End Date",
  "final_state_keys": [
    "user_query",
    "valid_query",
    "budget",
    "origin",
    "origin_code",
    "destination",
    "destination_code",
    "start_date",
    "end_date",
    "flight_results",
    "messages"
  ]
}
2025-10-27 20:09:39,970 - web_api_handle_request - INFO - execute:47 - Request handled successfully
2025-10-27 20:10:11,213 - web_api_handle_request - INFO - execute:12 - Received request to generate response for query: hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025...
2025-10-27 20:10:11,214 - web_api_handle_request - INFO - log_function_call:39 - Calling execute with params: {
  "user_query_length": 100,
  "user_query_preview": "hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025"
}
2025-10-27 20:10:13,488 - web_api_handle_request - INFO - log_function_result:44 - execute completed successfully. Result: {
  "response_length": 0,
  "response_preview": "",
  "final_state_keys": [
    "user_query",
    "valid_query",
    "budget",
    "origin",
    "origin_code",
    "destination",
    "destination_code",
    "start_date",
    "end_date",
    "flight_results",
    "messages"
  ]
}
2025-10-27 20:10:13,489 - web_api_handle_request - INFO - execute:47 - Request handled successfully
2025-10-27 20:40:16,284 - web_api_handle_request - INFO - execute:12 - Received request to generate response for query: hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025...
2025-10-27 20:40:16,285 - web_api_handle_request - INFO - log_function_call:39 - Calling execute with params: {
  "user_query_length": 100,
  "user_query_preview": "hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025"
}
2025-10-27 20:40:16,308 - web_api_handle_request - ERROR - log_function_error:51 - execute failed with error: 'coroutine' object has no attribute 'chain' | Params: {"user_query_length": 100, "user_query_preview": "hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025"}
Traceback (most recent call last):
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\web_api\application\handle_request.py", line 35, in execute
    output  = await self.graph.ainvoke(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\main.py", line 3182, in ainvoke
    async for chunk in self.astream(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\main.py", line 3000, in astream
    async for _ in runner.atick(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\_runner.py", line 304, in atick
    await arun_with_retry(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 705, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 473, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\travel_agent\application\nodes.py", line 39, in check_user_query
    response_chain = await self.llm_service.get_chain(chain_request).chain
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'chain'
During task with name 'check_user_query' and id '05c2a350-5471-994d-8a23-08d8a151bcb2'
2025-10-27 20:40:16,398 - web_api_handle_request - ERROR - execute:55 - Failed to handle request for query: hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025...
2025-10-27 20:41:03,031 - web_api_handle_request - INFO - execute:12 - Received request to generate response for query: hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025...
2025-10-27 20:41:03,031 - web_api_handle_request - INFO - log_function_call:39 - Calling execute with params: {
  "user_query_length": 100,
  "user_query_preview": "hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025"
}
2025-10-27 20:41:05,024 - web_api_handle_request - ERROR - log_function_error:51 - execute failed with error: 'coroutine' object has no attribute 'chain' | Params: {"user_query_length": 100, "user_query_preview": "hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025"}
Traceback (most recent call last):
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\web_api\application\handle_request.py", line 35, in execute
    output  = await self.graph.ainvoke(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\main.py", line 3182, in ainvoke
    async for chunk in self.astream(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\main.py", line 3000, in astream
    async for _ in runner.atick(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\_runner.py", line 304, in atick
    await arun_with_retry(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 705, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 473, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\travel_agent\application\nodes.py", line 75, in extractor_node
    response_chain = await self.llm_service.get_chain(chain_request).chain
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'coroutine' object has no attribute 'chain'
During task with name 'extractor_node' and id '8542eb8a-f5f4-e0a1-6d36-026259582f6f'
2025-10-27 20:41:05,027 - web_api_handle_request - ERROR - execute:55 - Failed to handle request for query: hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025...
2025-10-27 20:41:56,051 - web_api_handle_request - INFO - execute:12 - Received request to generate response for query: hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025...
2025-10-27 20:41:56,051 - web_api_handle_request - INFO - log_function_call:39 - Calling execute with params: {
  "user_query_length": 100,
  "user_query_preview": "hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025"
}
2025-10-27 20:42:00,372 - web_api_handle_request - INFO - log_function_result:44 - execute completed successfully. Result: {
  "response_length": 4,
  "response_preview": "None",
  "final_state_keys": [
    "user_query",
    "valid_query",
    "budget",
    "origin",
    "origin_code",
    "destination",
    "destination_code",
    "start_date",
    "end_date",
    "flight_results",
    "messages"
  ]
}
2025-10-27 20:42:00,373 - web_api_handle_request - INFO - execute:47 - Request handled successfully
2025-10-27 20:45:13,843 - web_api_handle_request - INFO - execute:12 - Received request to generate response for query: hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025...
2025-10-27 20:45:13,843 - web_api_handle_request - INFO - log_function_call:39 - Calling execute with params: {
  "user_query_length": 100,
  "user_query_preview": "hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025"
}
2025-10-27 20:45:18,440 - web_api_handle_request - ERROR - log_function_error:51 - execute failed with error: cannot import name 'LOCATION_SEARCH_PROMPT' from 'travel_agent.domain.prompts' (D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\travel_agent\domain\prompts.py) | Params: {"user_query_length": 100, "user_query_preview": "hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025"}
Traceback (most recent call last):
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\web_api\application\handle_request.py", line 35, in execute
    output  = await self.graph.ainvoke(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\main.py", line 3182, in ainvoke
    async for chunk in self.astream(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\main.py", line 3000, in astream
    async for _ in runner.atick(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\_runner.py", line 304, in atick
    await arun_with_retry(
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 705, in ainvoke
    input = await asyncio.create_task(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\.venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 473, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\travel_agent\application\nodes.py", line 115, in location_search_node
    from travel_agent.domain.prompts import LOCATION_SEARCH_PROMPT
ImportError: cannot import name 'LOCATION_SEARCH_PROMPT' from 'travel_agent.domain.prompts' (D:\BEYONDDATA\PROYECTOS\FlightSearchAgent\src\travel_agent\domain\prompts.py)
During task with name 'location_search_node' and id '134453a1-38a4-0f8c-d9c2-15480f6ef1b3'
2025-10-27 20:45:18,442 - web_api_handle_request - ERROR - execute:55 - Failed to handle request for query: hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025...
2025-10-27 20:46:37,535 - web_api_handle_request - INFO - execute:12 - Received request to generate response for query: hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025...
2025-10-27 20:46:37,535 - web_api_handle_request - INFO - log_function_call:39 - Calling execute with params: {
  "user_query_length": 100,
  "user_query_preview": "hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025"
}
2025-10-27 20:46:45,519 - web_api_handle_request - INFO - log_function_result:44 - execute completed successfully. Result: {
  "response_length": 4,
  "response_preview": "None",
  "final_state_keys": [
    "user_query",
    "valid_query",
    "budget",
    "origin",
    "origin_code",
    "destination",
    "destination_code",
    "start_date",
    "end_date",
    "flight_results",
    "messages"
  ]
}
2025-10-27 20:46:45,519 - web_api_handle_request - INFO - execute:47 - Request handled successfully
2025-10-27 20:48:33,289 - web_api_handle_request - INFO - execute:12 - Received request to generate response for query: hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025...
2025-10-27 20:48:33,289 - web_api_handle_request - INFO - log_function_call:39 - Calling execute with params: {
  "user_query_length": 100,
  "user_query_preview": "hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025"
}
2025-10-27 20:48:51,305 - web_api_handle_request - INFO - log_function_result:44 - execute completed successfully. Result: {
  "response_length": 809,
  "response_preview": "\u00a1Hola!\n\nGracias por contactarnos para tu viaje. Aqu\u00ed tienes la propuesta de viaje basada en la infor...",
  "final_state_keys": [
    "user_query",
    "valid_query",
    "budget",
    "origin",
    "origin_code",
    "destination",
    "destination_code",
    "start_date",
    "end_date",
    "flight_results",
    "messages"
  ]
}
2025-10-27 20:48:51,305 - web_api_handle_request - INFO - execute:47 - Request handled successfully
2025-10-27 21:10:41,547 - web_api_handle_request - INFO - execute:13 - Received request to generate response for query: hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025...
2025-10-27 21:10:41,569 - web_api_handle_request - INFO - log_function_call:39 - Calling execute with params: {
  "user_query_length": 100,
  "user_query_preview": "hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025"
}
2025-10-27 21:16:20,103 - web_api_handle_request - INFO - log_function_result:44 - execute completed successfully. Result: {
  "response_length": 262144,
  "response_preview": "NoneNoneNoneNoneNoneNoneNoneNoneNoneNoneNoneNoneNoneNoneNoneNoneNoneNoneNoneNoneNoneNoneNoneNoneNone...",
  "final_state_keys": [
    "user_query",
    "valid_query",
    "budget",
    "origin",
    "origin_code",
    "destination",
    "destination_code",
    "start_date",
    "end_date",
    "flight_results",
    "messages"
  ]
}
2025-10-27 21:16:20,114 - web_api_handle_request - INFO - execute:50 - Request handled successfully
2025-10-27 21:19:06,947 - web_api_handle_request - INFO - execute:13 - Received request to generate response for query: hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025...
2025-10-27 21:19:06,947 - web_api_handle_request - INFO - log_function_call:39 - Calling execute with params: {
  "user_query_length": 100,
  "user_query_preview": "hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025"
}
2025-10-27 21:19:24,219 - web_api_handle_request - INFO - log_function_result:44 - execute completed successfully. Result: {
  "response_length": 1736,
  "response_preview": "content='\u00a1Hola! Me complace presentarte una propuesta de viaje para tu aventura de Miami a Los \u00c1ngel...",
  "final_state_keys": [
    "user_query",
    "valid_query",
    "budget",
    "origin",
    "origin_code",
    "destination",
    "destination_code",
    "start_date",
    "end_date",
    "flight_results",
    "messages"
  ]
}
2025-10-27 21:19:24,220 - web_api_handle_request - INFO - execute:50 - Request handled successfully
2025-10-27 21:26:45,269 - web_api_handle_request - INFO - execute:14 - Received request to generate response for query: hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025...
2025-10-27 21:26:45,269 - web_api_handle_request - INFO - log_function_call:39 - Calling execute with params: {
  "user_query_length": 100,
  "user_query_preview": "hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025"
}
2025-10-27 21:29:24,133 - web_api_handle_request - INFO - execute:14 - Received request to generate response for query: hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025...
2025-10-27 21:29:24,133 - web_api_handle_request - INFO - log_function_call:39 - Calling execute with params: {
  "user_query_length": 100,
  "user_query_preview": "hola! quiero viajar desde miami hasta los angeles desl 28 de octubre hasta el 30 de octubre del 2025"
}
2025-10-27 21:29:53,838 - web_api_handle_request - INFO - log_function_result:44 - execute completed successfully. Result: {
  "response_length": 2,
  "response_preview": [
    "\nbudget='None'\norigin='miami'\ndestination='los angeles'\ndates='2025-10-28 - 2025-10-30'\nprice='574.09'\nairline='UA'\ndeparture_time='2025-10-28T08:00:00'\narrival_time='2025-10-30T15:44:00'\nduration='7h 31m / 6h 39m'\nflight_origin='MIA'\nflight_destination='MIA'\ntotal_cost='574.09'\nbudget_comparison='N/A'\ncurrency='USD'\ndeparture_date='2025-10-28'\narrival_date='2025-10-30'\nflight_details='Airline: UA, Price: $574.09, Departure Time: 2025-10-28T08:00:00, Arrival Time: 2025-10-30T15:44:00, Duration: 7h 31m / 6h 39m, Origin: MIA, Destination: MIA'\nflight_found='True'\nflight_destination_error='The flight destination in the results (MIA) does not match the requested destination (LAX).'\nflight_origin_error='The flight origin in the results (MIA) matches the requested origin (MIA).'\nflight_date_error='The flight departure date (2025-10-28) matches the requested start date (2025-10-28). The flight arrival date (2025-10-30) matches the requested end date (2025-10-30).'\nflight_price_error='The flight price is $574.09.'\nflight_duration_error='The flight duration is 7h 31m / 6h 39m.'\nflight_airline_error='The flight airline is UA.'\nflight_time_error='The flight departure time is 2025-10-28T08:00:00 and the arrival time is 2025-10-30T15:44:00.'\nflight_details_summary='Airline: UA, Price: $574.09, Departure Time: 2025-10-28T08:00:00, Arrival Time: 2025-10-30T15:44:00, Duration: 7h 31m / 6h 39m, Origin: MIA, Destination: MIA'\nflight_destination_mismatch_flag='True'\nflight_origin_match_flag='True'\nflight_date_match_flag='True'\nflight_price_present_flag='True'\nflight_duration_present_flag='True'\nflight_airline_present_flag='True'\nflight_time_present_flag='True'\nflight_details_complete_flag='True'\nflight_results_valid='False'\nflight_results_error_message='The flight destination in the results (MIA) does not match the requested destination (LAX).'",
    "\u00a1Hola!\n\nAqu\u00ed tienes la propuesta de viaje para tu vuelo de Miami a Los \u00c1ngeles.\n\n**Resumen de Vuelos Encontrados:**\n\nLamentablemente, no se encontraron vuelos directos o con escalas que coincidan con tu destino solicitado (Los \u00c1ngeles) para las fechas indicadas. Los resultados obtenidos muestran un vuelo de regreso al origen (MIA) en lugar de ir a Los \u00c1ngeles (LAX).\n\n**Detalles del Vuelo (No V\u00e1lido para tu Destino):**\n\n*   **Aerol\u00ednea:** UA\n*   **Precio:** $574.09\n*   **Salida:** 2025-10-28 a las 08:00 desde MIA\n*   **Llegada:** 2025-10-30 a las 15:44 a MIA (Este es el problema, deber\u00eda ser LAX)\n*   **Duraci\u00f3n:** 7h 31m / 6h 39m\n\n**Costo Total Estimado:**\n\nDado que los resultados de vuelo no corresponden al destino deseado, no podemos proporcionar un costo total estimado v\u00e1lido para tu viaje a Los \u00c1ngeles en este momento.\n\n**Comparaci\u00f3n con el Presupuesto:**\n\nNo se proporcion\u00f3 un presupuesto para este viaje.\n\n**Propuesta:**\n\nNo se pudo encontrar una opci\u00f3n de vuelo v\u00e1lida para tu viaje de Miami a Los \u00c1ngeles entre el 28 y el 30 de octubre de 2025 con los criterios actuales. Te sugiero que revisemos las fechas o consideremos aeropuertos alternativos si es posible."
  ],
  "final_state_keys": [
    "user_query",
    "valid_query",
    "budget",
    "origin",
    "origin_code",
    "destination",
    "destination_code",
    "start_date",
    "end_date",
    "flight_results",
    "messages"
  ]
}
2025-10-27 21:29:53,839 - web_api_handle_request - INFO - execute:51 - Request handled successfully
2025-10-27 21:37:22,140 - web_api_handle_request - INFO - execute:14 - Received request to generate response for query: hola! quiero viajar desde miami hasta new york desde el 28 de octubre hasta el 30 de octubre del 202...
2025-10-27 21:37:22,140 - web_api_handle_request - INFO - log_function_call:39 - Calling execute with params: {
  "user_query_length": 101,
  "user_query_preview": "hola! quiero viajar desde miami hasta new york desde el 28 de octubre hasta el 30 de octubre del 202..."
}
2025-10-27 21:37:48,783 - web_api_handle_request - INFO - log_function_result:44 - execute completed successfully. Result: {
  "response_length": 753,
  "response_preview": "\nHello!\n\nI'm happy to help you plan your trip from Miami to New York! I've found a flight option for...",
  "final_state_keys": [
    "user_query",
    "valid_query",
    "budget",
    "origin",
    "origin_code",
    "destination",
    "destination_code",
    "start_date",
    "end_date",
    "flight_results",
    "messages"
  ]
}
2025-10-27 21:37:48,783 - web_api_handle_request - INFO - execute:51 - Request handled successfully
